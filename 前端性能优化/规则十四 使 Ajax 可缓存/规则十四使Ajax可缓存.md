# 性能优化之十四使 Ajax 可缓存
Ajax 是 DHTML 中使用的一项技术，客户端可以获取和显示用户请求的新信息而无需重新加载页面。

## Ajax
Ajax 不是一个单独的、需要许可证的技术，而是一组技术，包括 Javascript、 CSS、 DOM 和异步数据获取。 Ajax 的目的是为了突破 Web 本质的开始-停止交互方式。它将 Web 体验从 "浏览页面" 转变为 "与应用程序进行交互"。

## 异步与即时
用户是否需要等待的关键因素在于 Ajax 请求时被动的还是主动的。   
被动请求： 是为了将来使用而预先发起的。  
主动请求： 是基于用户当前的操作而发起的。  
Ajax优点： 

* 用户不必忍受整个页面的重新加载了
* 当用户等待时， UI 仍然是可响应的

注意： 用户在进行进一步操作之前仍可能需要坐在那里，等待搜索结果显示出来，"异步" 并没有暗示"即时"。

## 优化 Ajax 请求
当发起主动 Ajax 请求时，用户可能仍须等待。优化主动 Ajax 请求的技术同样适用于被动 Ajax 请求，但主动请求对用户体验的影响更大。  
改善这些主动 Ajax 请求最重要的方式就是使响应可缓存（最重要的改进方法），如下这些规则也适用于优化 Ajax 请求：

* 规则4——压缩组件
* 规则9——减少 DNS 查找
* 规则10——精简 Javascript
* 规则11——避免重定向
* 规则13—— ETag——用还是不用

## 实践
使 Ajax 请求可缓存，除了改变 HTTP 头之外还需要进行更多的工作。响应的**个性化和动态本质**必须被反映到缓存中。可供采用的最好的方式是使用**查询字符串参数**。  
例如：

	/ws/mail/vl/formrpc?m=GetMessage&yid=steve_souders

确保产生变化后不会再使用缓存的请求，简单的解决方法还是使用查询字符串。例如可以用时间戳来代表资源末次修改发生的时间，并将其嵌入到 Ajax 请求查询的字符串中欧： 

	/ar?id=[snip...]&srow=0&erow=100&t=1177458941